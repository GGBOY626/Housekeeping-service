{"version":3,"file":"cancel.js","sources":["subPages/order/cancel.vue","../../../../develop/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFnZXNcb3JkZXJcY2FuY2VsLnZ1ZQ"],"sourcesContent":["<!--选择取消原因-->\r\n<template>\r\n  <view class=\"pageCon cancelBox\">\r\n    <!-- 标题 -->\r\n    <NavBar\r\n      :title=\"title\"\r\n      :isShowBack=\"true\"\r\n      :handleToLink=\"handleToLink\"\r\n    ></NavBar>\r\n    <!-- end -->\r\n    <view :style=\"{ paddingTop: capsuleBottom + 'px' }\">\r\n      <view class=\"radioList\">\r\n        <radio-group @change=\"radioChange\">\r\n          <label\r\n            class=\"uni-list-cell uni-list-cell-pd\"\r\n            v-for=\"(item, index) in cancelCauseData\"\r\n            :key=\"index\"\r\n          >\r\n            <view>{{ item.label }}</view>\r\n            <view>\r\n              <radio color=\"#F74346\" :value=\"item.label\" />\r\n            </view>\r\n          </label>\r\n        </radio-group>\r\n      </view>\r\n      <view class=\"pageFoot\">\r\n        <button\r\n          :class=\"canSubmit ? 'agree-btn btn' : 'disabled-btn btn'\"\r\n          @click=\"handleSubmit()\"\r\n        >\r\n          提交\r\n        </button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue';\r\nimport { onLoad } from '@dcloudio/uni-app';\r\n// 基本数据\r\nimport { cancelCauseData } from '@/utils/commonData.js';\r\nimport { tostTip } from '@/utils/index.js';\r\n// 接口\r\nimport { cancelOrder } from '@/pages/api/order.js';\r\nimport { useStore } from 'vuex';\r\n// 组件\r\n// ------定义变量------\r\nconst store = useStore(); //存储获取数据\r\nconst isSendRequest = ref(false); // 是否继续发送请求\r\nconst cancelData = ref(''); //要取消的内容\r\nconst orderId = ref(null); //订单id\r\nconst type = ref(null); //用来区分是取消还是退款\r\nconst title = ref(''); //标题\r\nconst tradingOrderNo = ref(''); //交易号\r\n//胶囊底部距离头部的距离\r\nlet capsuleBottom = ref();\r\n// ------定义方法------\r\nonLoad((option) => {\r\n  uni.getSystemInfo({\r\n    success: (res) => {\r\n      capsuleBottom.value = uni.getMenuButtonBoundingClientRect().bottom + 4;\r\n    },\r\n  });\r\n  orderId.value = option.id;\r\n  tradingOrderNo.value = option.tradingOrderNo;\r\n  type.value = option.type;\r\n  // 判断是取消还是退款\r\n  if (type.value === '4') {\r\n    title.value = '取消原因';\r\n  } else {\r\n    title.value = '退款原因';\r\n  }\r\n});\r\n\r\nconst canSubmit = computed(() => {\r\n  if (cancelData.value) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n});\r\n// 触发选择事件\r\nconst radioChange = (e) => {\r\n  cancelData.value = e.detail.value;\r\n};\r\n// 确定操作\r\nconst handleSubmit = async () => {\r\n  if (!isSendRequest.value) {\r\n    isSendRequest.value = true;\r\n    if (type.value === '4') {\r\n      await cancelOrder({\r\n        id: orderId.value,\r\n        cancelReason: cancelData.value,\r\n      }).then((res) => {\r\n        if (res.data.code === 200) {\r\n          tostTip('取消成功');\r\n          setTimeout(() => {\r\n            isSendRequest.value = false;\r\n            uni.navigateBack({\r\n              delta: 1,\r\n            });\r\n          }, 1000);\r\n        }else{\r\n          isSendRequest.value = false;\r\n          tostTip(res.data.msg);\r\n        }\r\n      });\r\n    } else {\r\n      // 退款\r\n      parent = {\r\n        ...parent,\r\n        tradingOrderNo: tradingOrderNo.value,\r\n        tradingChannel: cancelData.value,\r\n      };\r\n      await orderRefund(parent).then((res) => {\r\n        if (res.code === 200) {\r\n          tostTip('提交成功');\r\n          setTimeout(() => {\r\n            isSendRequest.value = false;\r\n          }, 1000);\r\n          uni.navigateTo({\r\n            url: `/subPages/order/index`,\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n// 列表页返回订单列表\r\nconst handleToLink = () => {\r\n  uni.navigateBack({\r\n    delta: 1,\r\n  });\r\n};\r\n</script>\r\n\r\n<style src=\"./index.scss\" lang=\"scss\" scoped></style>\r\n<style lang=\"scss\" scoped>\r\n:deep(.NavBar) {\r\n  background: #fff !important;\r\n  position: fixed !important;\r\n  top: 0;\r\n  width: 100%;\r\n  z-index: 999;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/class_project/jzo2o/jzo2o-front/jzo2o-consumer/subPages/order/cancel.vue'\nwx.createPage(MiniProgramPage)"],"names":["useStore","ref","onLoad","uni","computed","cancelOrder","tostTip"],"mappings":";;;;;;;;;;;;AAgDcA,kBAAAA,SAAW;AACzB,UAAM,gBAAgBC,cAAAA,IAAI,KAAK;AAC/B,UAAM,aAAaA,cAAAA,IAAI,EAAE;AACzB,UAAM,UAAUA,cAAAA,IAAI,IAAI;AACxB,UAAM,OAAOA,cAAAA,IAAI,IAAI;AACrB,UAAM,QAAQA,cAAAA,IAAI,EAAE;AACpB,UAAM,iBAAiBA,cAAAA,IAAI,EAAE;AAE7B,QAAI,gBAAgBA,cAAG,IAAA;AAEvBC,kBAAM,OAAC,CAAC,WAAW;AACjBC,oBAAAA,MAAI,cAAc;AAAA,QAChB,SAAS,CAAC,QAAQ;AAChB,wBAAc,QAAQA,cAAG,MAAC,gCAA+B,EAAG,SAAS;AAAA,QACtE;AAAA,MACL,CAAG;AACD,cAAQ,QAAQ,OAAO;AACvB,qBAAe,QAAQ,OAAO;AAC9B,WAAK,QAAQ,OAAO;AAEpB,UAAI,KAAK,UAAU,KAAK;AACtB,cAAM,QAAQ;AAAA,MAClB,OAAS;AACL,cAAM,QAAQ;AAAA,MACf;AAAA,IACH,CAAC;AAED,UAAM,YAAYC,cAAQ,SAAC,MAAM;AAC/B,UAAI,WAAW,OAAO;AACpB,eAAO;AAAA,MACX,OAAS;AACL,eAAO;AAAA,MACR;AAAA,IACH,CAAC;AAED,UAAM,cAAc,CAAC,MAAM;AACzB,iBAAW,QAAQ,EAAE,OAAO;AAAA,IAC9B;AAEA,UAAM,eAAe,YAAY;AAC/B,UAAI,CAAC,cAAc,OAAO;AACxB,sBAAc,QAAQ;AACtB,YAAI,KAAK,UAAU,KAAK;AACtB,gBAAMC,4BAAY;AAAA,YAChB,IAAI,QAAQ;AAAA,YACZ,cAAc,WAAW;AAAA,UACjC,CAAO,EAAE,KAAK,CAAC,QAAQ;AACf,gBAAI,IAAI,KAAK,SAAS,KAAK;AACzBC,0BAAO,QAAC,MAAM;AACd,yBAAW,MAAM;AACf,8BAAc,QAAQ;AACtBH,8BAAAA,MAAI,aAAa;AAAA,kBACf,OAAO;AAAA,gBACrB,CAAa;AAAA,cACF,GAAE,GAAI;AAAA,YACjB,OAAa;AACH,4BAAc,QAAQ;AACtBG,0BAAAA,QAAQ,IAAI,KAAK,GAAG;AAAA,YACrB;AAAA,UACT,CAAO;AAAA,QACP,OAAW;AAEL,mBAAS;AAAA,YACP,GAAG;AAAA,YACH,gBAAgB,eAAe;AAAA,YAC/B,gBAAgB,WAAW;AAAA,UACnC;AACM,gBAAM,YAAY,MAAM,EAAE,KAAK,CAAC,QAAQ;AACtC,gBAAI,IAAI,SAAS,KAAK;AACpBA,0BAAO,QAAC,MAAM;AACd,yBAAW,MAAM;AACf,8BAAc,QAAQ;AAAA,cACvB,GAAE,GAAI;AACPH,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA,cACjB,CAAW;AAAA,YACF;AAAA,UACT,CAAO;AAAA,QACF;AAAA,MACF;AAAA,IACH;AAEA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,aAAa;AAAA,QACf,OAAO;AAAA,MACX,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;ACrIA,GAAG,WAAW,eAAe;"}