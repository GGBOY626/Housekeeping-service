{"version":3,"file":"list.js","sources":["subPages/order/components/list.vue","../../../../develop/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY2xhc3NfcHJvamVjdC9qem8yby9qem8yby1mcm9udC9qem8yby1jb25zdW1lci9zdWJQYWdlcy9vcmRlci9jb21wb25lbnRzL2xpc3QudnVl"],"sourcesContent":["<!--订单列表-->\r\n<template>\r\n  <view>\r\n    <!-- tab切换 -->\r\n    <view class=\"tabScroll\" v-if=\"history !== true\">\r\n      <view class=\"itemTab box\">\r\n        <view class=\"tabBox\" :class=\"activeIndex === '' ? 'active' : ''\">\r\n          <view\r\n            class=\"tabItem\"\r\n            :class=\"activeIndex === item.value ? 'active' : ''\"\r\n            v-for=\"(item, index) in orderTabData\"\r\n            @click=\"changeTab(item.value)\"\r\n            :key=\"index\"\r\n          >\r\n            <view class=\"bLine\"></view>\r\n            {{ item.label }}\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <!-- end -->\r\n    <!-- 列表 -->\r\n    <view class=\"main\">\r\n      <!-- 垂直滚动区域  scroll和swiper的高度都要给且是一样的高度-->\r\n      <view>\r\n        <scroll-view scroll-y=\"true\">\r\n          <view class=\"timeList\">\r\n            <view\r\n              class=\"box boxRadius item\"\r\n              v-for=\"(item, index) in itemData\"\r\n              :key=\"index\"\r\n            >\r\n              <view class=\"itemCon\" @click.stop=\"handleDetail(item.id)\">\r\n                <view class=\"head\">\r\n                  <image :src=\"item.serveItemImg\"></image>\r\n                </view>\r\n                <view class=\"rText\">\r\n                  <view class=\"itemTit tit\"\r\n                    ><text>{{ item.serveItemName }}</text\r\n                    ><text v-if=\"item.ordersStatus === 0\" class=\"font-col\"\r\n                      >待支付</text\r\n                    ><text v-if=\"item.ordersStatus === 100\" class=\"font-col\"\r\n                      >派单中</text\r\n                    ><text v-if=\"item.ordersStatus === 200\" class=\"font-col\"\r\n                      >待服务</text\r\n                    ><text v-if=\"item.ordersStatus === 300\" class=\"font-col\"\r\n                      >服务中</text\r\n                    ><text v-if=\"item.ordersStatus === 400\" class=\"font-col\"\r\n                      >待评价</text\r\n                    ><text v-if=\"item.ordersStatus === 500\">已完成</text\r\n                    ><text v-if=\"item.ordersStatus === 600\" class=\"font-grey\"\r\n                      >已取消</text\r\n                    >\r\n                    <text v-if=\"item.ordersStatus === 700\" class=\"font-grey\"\r\n                      >已关闭</text\r\n                    >\r\n                  </view>\r\n                  <view class=\"info\">{{\r\n                    formatDateTimeToDateTimeString(\r\n                      new Date(item.serveStartTime?.replace(/-/g, '/'))\r\n                    )\r\n                  }}</view>\r\n                </view>\r\n              </view>\r\n              <view class=\"address\">{{ item.serveAddress }} </view>\r\n              <view\r\n                class=\"foot\"\r\n                v-if=\"item.ordersStatus === 0 || item.ordersStatus === 400\"\r\n              >\r\n                <view class=\"amount\" v-if=\"item.ordersStatus === 0\"\r\n                  >待支付金额：<text class=\"font-col\"\r\n                    >￥{{ item.realPayAmount }}</text\r\n                  ></view\r\n                >\r\n                <view class=\"amount\" v-else></view>\r\n                <!-- <span class=\"bt bt-grey inputW\" v-if=\"item.ordersStatus===0\" @click=\"handleCancel(item.id)\">取消订单</span> -->\r\n                <view\r\n                  class=\"btn inputW\"\r\n                  v-if=\"item.ordersStatus === 0\"\r\n                  @click=\"handlePay(item)\"\r\n                  >去支付</view\r\n                >\r\n                <view\r\n                  class=\"btn inputW\"\r\n                  v-if=\"item.ordersStatus === 400\"\r\n                  @click=\"handleEvaluation(item)\"\r\n                  >去评价</view\r\n                >\r\n                <!-- <view class=\"bt bt-grey inputW\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"(item.ordersStatus===1&&!item.refundRecordVo.refundStatus)||(item.status===1&&item.refundRecordVo.refundStatus===3)\"\r\n\t\t\t\t\t\t\t\t\t@click=\"handleRefund(item.tradingOrderNo)\">退款</view>\r\n\t\t\t\t\t\t\t\t<view class=\"bt bt-grey inputW\" v-if=\"item.status!==0&&item.status!==1\"\r\n\t\t\t\t\t\t\t\t\t@click=\"handleDelete(item.id)\">删除</view> -->\r\n              </view>\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 下拉加载更多Lodding -->\r\n          <view v-if=\"itemData.length > 6\"\r\n            ><uni-load-more :status=\"moreStatus\" :content-text=\"contentText\"\r\n          /></view>\r\n          <!-- end -->\r\n        </scroll-view>\r\n      </view>\r\n      <!-- 无数据显示 -->\r\n      <view v-if=\"itemData.length === 0 && loading\">\r\n        <EmptyPage :emptyInfo=\"emptyInfo\" />\r\n      </view>\r\n      <!-- end -->\r\n    </view>\r\n    <!-- end -->\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, watch } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport {\r\n  getNow,\r\n  getTime,\r\n  decimalsReplenish,\r\n  formatDateTimeToDateTimeString,\r\n} from '@/utils/index.js';\r\nimport { onReachBottom, onShow, onLoad } from '@dcloudio/uni-app';\r\n// 组件\r\n// 无数据\r\nimport EmptyPage from '@/components/EmptyPage/index.vue';\r\n// 基础数据\r\nimport { orderTabData } from '@/utils/commonData.js';\r\n// 获取父组件值、方法\r\nconst props = defineProps({\r\n  itemData: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n  moreStatus: {\r\n    type: String,\r\n    default: 'noMore',\r\n  },\r\n  loading: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  history: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n});\r\n// ------定义变量------\r\nconst store = useStore(); //存储获取数据\r\nconst users = store.state.user; //获取存储数据\r\nconst emit = defineEmits(['setTabIndex', 'onReachBottom', 'handleDelete']);\r\nconst activeIndex = ref(users.orderStatus === '' ? 7 : users.orderStatus); //当前tab\r\nconst scrollinto = ref('tab0'); //tab切换\r\nconst emptyInfo = ref('暂无订单哦~');\r\nconst contentText = ref({\r\n  //加载状态说明\r\n  contentdown: '上拉加载更多',\r\n  contentrefresh: '努力加载中...',\r\n  contentnomore: '- 没有更多了 -',\r\n});\r\nconst pagesCount = ref(null);\r\n//胶囊底部距离头部的距离\r\nlet capsuleBottom = ref();\r\n// ------定义方法------\r\nonLoad(() => {\r\n  uni.getSystemInfo({\r\n    success: (res) => {\r\n      capsuleBottom.value = uni.getMenuButtonBoundingClientRect().bottom + 12;\r\n    },\r\n  });\r\n  let pages = getCurrentPages();\r\n  pagesCount.value = pages.length;\r\n});\r\n\r\n// 切换tab\r\nconst changeTab = (index) => {\r\n  // 点击的还是当前数据的时候直接return\r\n  if (activeIndex.value == index) {\r\n    return;\r\n  }\r\n  activeIndex.value = index;\r\n  emit('setTabIndex', index);\r\n};\r\n// 上拉刷新\r\nfunction scrolltoupperHandle() {\r\n  emit('setTabIndex', index);\r\n}\r\n// 进入取消页面\r\nconst handleCancel = (id) => {\r\n  handleNavigate(id, 4);\r\n};\r\n// 进入退款原因页面\r\nconst handleRefund = (id) => {\r\n  handleNavigate(id, 5);\r\n};\r\n// 取消、退款原因页面\r\nconst handleNavigate = (id, num) => {\r\n  // store.commit('user/setBackLike', 'cancel');\r\n  uni.navigateTo({\r\n    url: `/subPages/order/cancel?tradingOrderNo=${id}&type=` + num,\r\n  });\r\n};\r\n\r\n// 去支付\r\nconst handlePay = (val) => {\r\n  let cheapPrice = 0;\r\n  cheapPrice = val.price - val.realPayAmount;\r\n  uni.navigateTo({\r\n    url:\r\n      '/pages/pay/index?id=' +\r\n      val.id +\r\n      '&price=' +\r\n      val.price +\r\n      '&time=' +\r\n      val.createTime +\r\n      '&cheapPrice=' +\r\n      cheapPrice,\r\n  });\r\n};\r\n\r\n// 进入订单详情\r\nconst handleDetail = (id) => {\r\n  if (props.history === true) {\r\n    uni.navigateTo({\r\n      url: `/subPages/history/details?id=${id}&type=history`,\r\n    });\r\n  } else {\r\n    uni.navigateTo({\r\n      url: `/subPages/order/details?id=${id}&type=order`,\r\n    });\r\n  }\r\n};\r\nconst handleEvaluation = (val) => {\r\n  uni.navigateTo({\r\n    url: `/subPages/order/components/evaluate?id=${val.id}&type=order`,\r\n  });\r\n};\r\n// 上下拉取\r\nonReachBottom(() => {\r\n  emit('onReachBottom');\r\n});\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import url('@/styles/theme.scss');\r\n.btn {\r\n  width: 156rpx;\r\n  height: 60rpx;\r\n  line-height: 60rpx;\r\n  text-align: center;\r\n  color: var(--essential-color-red);\r\n}\r\n.item {\r\n  &:nth-child(1) {\r\n    margin-top: 16rpx;\r\n  }\r\n}\r\n.address {\r\n  margin-top: 4rpx;\r\n  padding-left: 12rpx;\r\n  padding-right: 12rpx;\r\n  font-family: PingFangSC-Regular;\r\n  font-weight: 400;\r\n  font-size: 28rpx;\r\n  color: #888888;\r\n  letter-spacing: 0.16px;\r\n  margin-bottom: 20rpx;\r\n}\r\n</style>\r\n","import Component from 'D:/class_project/jzo2o/jzo2o-front/jzo2o-consumer/subPages/order/components/list.vue'\nwx.createComponent(Component)"],"names":["useStore","ref","onLoad","uni","onReachBottom"],"mappings":";;;;;;;;;;;;AA8HA,MAAM,YAAY,MAAW;;;;;;;;;;;;;;;;;;;;;;;AAI7B,UAAM,QAAQ;AAmBd,UAAM,QAAQA,cAAQ,SAAA;AACtB,UAAM,QAAQ,MAAM,MAAM;AAC1B,UAAM,OAAO;AACb,UAAM,cAAcC,cAAAA,IAAI,MAAM,gBAAgB,KAAK,IAAI,MAAM,WAAW;AACrDA,kBAAG,IAAC,MAAM;AAC7B,UAAM,YAAYA,cAAAA,IAAI,QAAQ;AAC9B,UAAM,cAAcA,cAAAA,IAAI;AAAA;AAAA,MAEtB,aAAa;AAAA,MACb,gBAAgB;AAAA,MAChB,eAAe;AAAA,IACjB,CAAC;AACD,UAAM,aAAaA,cAAAA,IAAI,IAAI;AAE3B,QAAI,gBAAgBA,cAAG,IAAA;AAEvBC,kBAAAA,OAAO,MAAM;AACXC,oBAAAA,MAAI,cAAc;AAAA,QAChB,SAAS,CAAC,QAAQ;AAChB,wBAAc,QAAQA,cAAG,MAAC,gCAA+B,EAAG,SAAS;AAAA,QACtE;AAAA,MACL,CAAG;AACD,UAAI,QAAQ;AACZ,iBAAW,QAAQ,MAAM;AAAA,IAC3B,CAAC;AAGD,UAAM,YAAY,CAAC,UAAU;AAE3B,UAAI,YAAY,SAAS,OAAO;AAC9B;AAAA,MACD;AACD,kBAAY,QAAQ;AACpB,WAAK,eAAe,KAAK;AAAA,IAC3B;AAsBA,UAAM,YAAY,CAAC,QAAQ;AACzB,UAAI,aAAa;AACjB,mBAAa,IAAI,QAAQ,IAAI;AAC7BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KACE,yBACA,IAAI,KACJ,YACA,IAAI,QACJ,WACA,IAAI,aACJ,iBACA;AAAA,MACN,CAAG;AAAA,IACH;AAGA,UAAM,eAAe,CAAC,OAAO;AAC3B,UAAI,MAAM,YAAY,MAAM;AAC1BA,sBAAAA,MAAI,WAAW;AAAA,UACb,KAAK,gCAAgC,EAAE;AAAA,QAC7C,CAAK;AAAA,MACL,OAAS;AACLA,sBAAAA,MAAI,WAAW;AAAA,UACb,KAAK,8BAA8B,EAAE;AAAA,QAC3C,CAAK;AAAA,MACF;AAAA,IACH;AACA,UAAM,mBAAmB,CAAC,QAAQ;AAChCA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,0CAA0C,IAAI,EAAE;AAAA,MACzD,CAAG;AAAA,IACH;AAEAC,kBAAAA,cAAc,MAAM;AAClB,WAAK,eAAe;AAAA,IACtB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChPD,GAAG,gBAAgB,SAAS;"}