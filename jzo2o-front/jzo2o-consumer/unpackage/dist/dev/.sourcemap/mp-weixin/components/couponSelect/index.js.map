{"version":3,"file":"index.js","sources":["components/couponSelect/index.vue","../../../../develop/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY2xhc3NfcHJvamVjdC9qem8yby9qem8yby1mcm9udC9qem8yby1jb25zdW1lci9jb21wb25lbnRzL2NvdXBvblNlbGVjdC9pbmRleC52dWU"],"sourcesContent":["<!-- 优惠券弹窗 -->\r\n<template>\r\n  <view class=\"getCouponPicker\">\r\n    <uni-popup\r\n      ref=\"popup\"\r\n      type=\"bottom\"\r\n      :safe-area=\"false\"\r\n      mask-background-color=\"rgba(0,0,0,0.6)\"\r\n    >\r\n      <view class=\"header\">\r\n        <view class=\"header-title\">优惠券</view>\r\n        <view class=\"close\" @click=\"handleCancel\"></view>\r\n      </view>\r\n      <!-- 优惠券 -->\r\n      <scroll-view scroll-y=\"true\" class=\"body\">\r\n        <view class=\"couponList\">\r\n          <view\r\n            class=\"box boxRadius item\"\r\n            v-for=\"(item, index) in itemData\"\r\n            :key=\"index\"\r\n          >\r\n            <view class=\"left\">\r\n              <view class=\"price\">\r\n                <text class=\"unit\" v-if=\"item.type === 1\">￥</text>\r\n                <text class=\"money\"\r\n                  >{{\r\n                    item.type === 1\r\n                      ? Number(item.discountAmount).toFixed(0)\r\n                      : convertDiscountPercentageToNumber(\r\n                          Number(item.discountRate)\r\n                        ).integer\r\n                  }}\r\n                </text>\r\n                <text v-if=\"item.type === 2\">{{\r\n                  convertDiscountPercentageToNumber(Number(item.discountRate))\r\n                    .decimal\r\n                }}</text>\r\n                <text class=\"unit\" v-if=\"item.type === 2\">折</text>\r\n              </view>\r\n            </view>\r\n            <view class=\"right\">\r\n              <view class=\"title\">{{ item.name }}</view>\r\n              <view class=\"select\">\r\n                <view class=\"time\" v-if=\"item.type === 1\">\r\n                  <text v-if=\"Number(item.amountCondition).toFixed(0) == 0\" class=\"mainColor\"\r\n                    >无门槛</text\r\n                  ><text v-else class=\"mainColor\"\r\n                    >满{{ Number(item.amountCondition).toFixed(0) }}元</text\r\n                  >立减{{ Number(item.discountAmount).toFixed(0) }}元\r\n                </view>\r\n                <view class=\"time\" v-if=\"item.type === 2\">\r\n                  <text v-if=\"Number(item.amountCondition).toFixed(0) == 0\" class=\"mainColor\"\r\n                    >无门槛</text\r\n                  ><text v-else class=\"mainColor\"\r\n                    >满{{ Number(item.amountCondition).toFixed(0) }}元</text\r\n                  >立享{{\r\n                    convertDiscountPercentageToNumber(Number(item.discountRate))\r\n                      .integer\r\n                  }}{{\r\n                    convertDiscountPercentageToNumber(Number(item.discountRate))\r\n                      .decimal\r\n                  }}折\r\n                </view>\r\n                <view\r\n                  :class=\"activeId === item.id ? 'active' : 'checkbox'\"\r\n                  @click=\"handleActive(item)\"\r\n                ></view>\r\n              </view>\r\n              <view class=\"time\">\r\n                <text>有效期至：</text\r\n                >{{\r\n                  formatDateTimeToDateString(\r\n                    new Date(item.validityTime.replace(/-/g, '/'))\r\n                  )\r\n                }}\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </scroll-view>\r\n      <view class=\"pageFoot\">\r\n        <button @click=\"handleSub\" class=\"agree-btn btn\">确定</button>\r\n      </view>\r\n    </uni-popup>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue';\r\nimport {\r\n  formatDateTimeToDateString,\r\n  convertDiscountPercentageToNumber,\r\n} from '@/utils/index.js';\r\nconst emits = defineEmits(['handleSelectCoupon']);\r\nconst popup = ref();\r\nconst itemData = ref([]);\r\nconst activeId = ref(1);\r\nconst activeData = ref({});\r\nconst props = defineProps({\r\n  // 是否显示\r\n  activeCoupon: {\r\n    type: Object,\r\n  },\r\n  couponList: {\r\n    type: Array,\r\n  },\r\n});\r\nwatch(\r\n  () => props.couponList,\r\n  (val) => {\r\n    itemData.value = val;\r\n  }\r\n);\r\nwatch(\r\n  () => props.activeCoupon,\r\n  (val) => {\r\n    activeId.value = val?.id ? val?.id : 1;\r\n  }\r\n);\r\n// 打开弹层\r\nconst handleOpen = () => {\r\n  popup.value.open('bottom');\r\n};\r\n// 关闭弹层\r\nconst handleCancel = () => {\r\n  popup.value.close('bottom');\r\n};\r\n\r\nconst handleActive = (val) => {\r\n  if(val.id === activeId.value) {\r\n    activeId.value = 1;\r\n    activeData.value = {};\r\n    return;\r\n  }\r\n  activeId.value = val.id;\r\n  activeData.value = val;\r\n};\r\n\r\n// 确定选择优惠券\r\nconst handleSub = () => {\r\n  emits('handleSelectCoupon', activeData.value);\r\n};\r\n// 暴漏给父组件\r\ndefineExpose({\r\n  handleOpen,\r\n  handleCancel,\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped src=\"./index.scss\"></style>\r\n<style lang=\"scss\">\r\n.getCouponPicker .uni-popup__wrapper {\r\n  max-height: 1062rpx;\r\n  background-color: white !important;\r\n  border-radius: 24rpx 24rpx 0 0;\r\n}\r\n.mainColor {\r\n  color: #19232b !important;\r\n}\r\n</style>\r\n","import Component from 'D:/class_project/jzo2o/jzo2o-front/jzo2o-consumer/components/couponSelect/index.vue'\nwx.createComponent(Component)"],"names":["ref","watch"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA6FA,UAAM,QAAQ;AACd,UAAM,QAAQA,cAAG,IAAA;AACjB,UAAM,WAAWA,cAAAA,IAAI,CAAA,CAAE;AACvB,UAAM,WAAWA,cAAAA,IAAI,CAAC;AACtB,UAAM,aAAaA,cAAAA,IAAI,CAAA,CAAE;AACzB,UAAM,QAAQ;AASdC,kBAAK;AAAA,MACH,MAAM,MAAM;AAAA,MACZ,CAAC,QAAQ;AACP,iBAAS,QAAQ;AAAA,MAClB;AAAA,IACH;AACAA,kBAAK;AAAA,MACH,MAAM,MAAM;AAAA,MACZ,CAAC,QAAQ;AACP,iBAAS,SAAQ,2BAAK,MAAK,2BAAK,KAAK;AAAA,MACtC;AAAA,IACH;AAEA,UAAM,aAAa,MAAM;AACvB,YAAM,MAAM,KAAK,QAAQ;AAAA,IAC3B;AAEA,UAAM,eAAe,MAAM;AACzB,YAAM,MAAM,MAAM,QAAQ;AAAA,IAC5B;AAEA,UAAM,eAAe,CAAC,QAAQ;AAC5B,UAAG,IAAI,OAAO,SAAS,OAAO;AAC5B,iBAAS,QAAQ;AACjB,mBAAW,QAAQ;AACnB;AAAA,MACD;AACD,eAAS,QAAQ,IAAI;AACrB,iBAAW,QAAQ;AAAA,IACrB;AAGA,UAAM,YAAY,MAAM;AACtB,YAAM,sBAAsB,WAAW,KAAK;AAAA,IAC9C;AAEA,aAAa;AAAA,MACX;AAAA,MACA;AAAA,IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjJD,GAAG,gBAAgB,SAAS;"}