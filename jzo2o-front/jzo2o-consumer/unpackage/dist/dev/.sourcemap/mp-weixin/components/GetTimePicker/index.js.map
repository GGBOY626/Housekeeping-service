{"version":3,"file":"index.js","sources":["components/GetTimePicker/index.vue","../../../../develop/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY2xhc3NfcHJvamVjdC9qem8yby9qem8yby1mcm9udC9qem8yby1jb25zdW1lci9jb21wb25lbnRzL0dldFRpbWVQaWNrZXIvaW5kZXgudnVl"],"sourcesContent":["<!-- 期待上门时间弹窗 -->\r\n<template>\r\n  <view class=\"getTimePicker\">\r\n    <uni-popup\r\n      ref=\"popup\"\r\n      type=\"bottom\"\r\n      :safe-area=\"false\"\r\n      mask-background-color=\"rgba(0,0,0,0.6)\"\r\n    >\r\n      <view class=\"header\">\r\n        <view class=\"remove\" @click=\"handleCancel\">取消</view>\r\n        <view class=\"confirm\" @click=\"handleConfirm\">确认</view>\r\n      </view>\r\n      <!-- 时间选择区域 -->\r\n      <view class=\"time-select\">\r\n        <view class=\"select-day\">\r\n          <scroll-view\r\n            scroll-y\r\n            :scroll-top=\"scrollTop\"\r\n            @scroll=\"scroll\"\r\n            :scroll-into-view=\"scrollIntoViewDay\"\r\n          >\r\n            <view\r\n              :class=\"selectedDay === index ? 'active' : ''\"\r\n              class=\"select-day-item\"\r\n              @click=\"handleSelectDay(index, item)\"\r\n              v-for=\"(item, index) in selectDay\"\r\n              :key=\"index\"\r\n              :id=\"`Day${index}`\"\r\n            >\r\n              {{ item }}\r\n            </view>\r\n          </scroll-view>\r\n        </view>\r\n        <view class=\"select-time\">\r\n          <scroll-view\r\n            scroll-y\r\n            :scroll-top=\"scrollTopTime\"\r\n            @scroll=\"scrollTime\"\r\n            :scroll-into-view=\"scrollIntoViewTime\"\r\n          >\r\n            <view\r\n              :class=\"selectedTime === item.value ? 'active' : ''\"\r\n              class=\"time-item\"\r\n              v-for=\"(item, index) in selectedDay === 0\r\n                ? todayList.todos\r\n                : dateList\"\r\n              :key=\"index\"\r\n              @click=\"handleSelectTime(item.value, item.label)\"\r\n              :id=\"`Time${item.value}`\"\r\n            >\r\n              <view class=\"time-value\">{{ item.label }}</view>\r\n            </view>\r\n          </scroll-view>\r\n        </view>\r\n      </view>\r\n    </uni-popup>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch } from 'vue';\r\nconst emits = defineEmits(['@getTime']);\r\n\r\nconst props = defineProps({\r\n  // 是否显示\r\n  hour: {\r\n    type: Number,\r\n    default: 0,\r\n  },\r\n});\r\nconst popup = ref();\r\nlet scrollTop = ref(0); //顶部位置\r\nlet scrollTopTime = ref(0); //顶部位置\r\nlet selectedDay = ref(0); //选中的日期的value\r\nlet selectedDayLabel = ref(''); //选中的日期的标签名\r\nlet selectedTime = ref();\r\nlet selectedTimeLabel = ref();\r\nconst scrollIntoViewDay = ref('Day0');\r\nconst scrollIntoViewTime = ref('');\r\nconst selectDay = ref([]);\r\nlet todayList = reactive({\r\n  todos: [\r\n  ],\r\n});\r\n// 列表中的时间段\r\nconst dateList = reactive(\r\n  // 弹窗中的时间列表,24小时制,每半小时一个选项\r\n  Array.from(\r\n    {\r\n      length: 48,\r\n    },\r\n    (v, i) => {\r\n      let hour = Math.floor(i / 2);\r\n      let minute = i % 2 === 0 ? '00' : '30';\r\n      return {\r\n        label: `${hour}:${minute}`,\r\n        value: i,\r\n      };\r\n    }\r\n  )\r\n);\r\n// 拼接获取近七天的日期\r\nconst getTime = () => {\r\n  let arr = [];\r\n  for (let i = 0; i < 7; i++) {\r\n    let date = new Date();\r\n    date.setDate(date.getDate() + i);\r\n    let year = date.getFullYear();\r\n    let month = date.getMonth() + 1;\r\n    let day = date.getDate();\r\n    // 自动补零\r\n    month = month < 10 ? `0${month}` : month;\r\n    day = day < 10 ? `0${day}` : day;\r\n    arr.push(`${year}-${month}-${day}`);\r\n  }\r\n  selectDay.value = arr;\r\n  if (!selectedDay.value) {\r\n    selectedDayLabel.value = selectDay.value[0];\r\n  }\r\n};\r\n// 滚动时触发\r\nconst scroll = (e) => {\r\n  scrollTop.value = e.detail.scrollTop;\r\n};\r\n// 滚动时触发\r\nconst scrollTime = (e) => {\r\n  scrollTopTime.value = e.detail.scrollTop;\r\n};\r\n//选择具体时间段\r\nconst handleSelectTime = (index, item) => {\r\n  selectedTime.value = index;\r\n  selectedTimeLabel.value = item;\r\n  popup.value.close('bottom');\r\n  emits('getTime', {\r\n    selectedDay: selectedDay.value,\r\n    selectedDayLabel: selectedDayLabel.value,\r\n    selectedTime: selectedTime.value,\r\n    selectedTimeLabel: selectedTimeLabel.value,\r\n  });\r\n};\r\n//选择哪天\r\nconst handleSelectDay = (index, item) => {\r\n  selectedDay.value = index;\r\n  selectedTime.value = 0;\r\n  selectedDayLabel.value = item;\r\n};\r\n// 打开弹层\r\nconst handleOpen = () => {\r\n  popup.value.open('bottom');\r\n  scrollIntoViewTime.value = `Time${selectedTime.value}`;\r\n  scrollIntoViewDay.value = `Day${selectedDay.value}`;\r\n  getTime();\r\n};\r\n// 关闭弹层\r\nconst handleCancel = () => {\r\n  popup.value.close('bottom');\r\n};\r\n// 切换日期时,默认选中第一个时间段\r\nwatch(\r\n  () => selectedDay.value,\r\n  () => {\r\n    selectedTimeLabel.value =\r\n      selectedDay.value === 0 ? todayList.todos[0].label : dateList[0].label;\r\n    // 时间滚动到顶部\r\n    scrollTopTime.value = 0;\r\n  }\r\n);\r\n// 打开弹层时,默认选中第一个时间段\r\nwatch(\r\n  () => props.hour,\r\n  () => {\r\n    let hour = props.hour;\r\n    let halfHour = new Date().getMinutes() > 30 ? 0.5 : 0;\r\n    hour += halfHour;\r\n    todayList.todos = [\r\n      ...todayList.todos.concat(\r\n        dateList.filter((item) => item.value / 2 >= hour + 2)\r\n      ),\r\n    ];\r\n    selectedTime.value = todayList.todos[0].value;\r\n    selectedTimeLabel.value = todayList.todos[0].label;\r\n  }\r\n);\r\n// 确认提交\r\nconst handleConfirm = () => {\r\n  popup.value.close('bottom');\r\n\r\n  emits('getTime', {\r\n    selectedDay: selectedDay.value,\r\n    selectedDayLabel: selectedDayLabel.value,\r\n    selectedTime: selectedTime.value,\r\n    selectedTimeLabel: selectedTimeLabel.value,\r\n  });\r\n};\r\n// 暴漏给父组件\r\ndefineExpose({\r\n  handleOpen,\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped src=\"./index.scss\"></style>\r\n","import Component from 'D:/class_project/jzo2o/jzo2o-front/jzo2o-consumer/components/GetTimePicker/index.vue'\nwx.createComponent(Component)"],"names":["ref","reactive","watch"],"mappings":"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"}