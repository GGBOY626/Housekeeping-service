{"version":3,"file":"list.js","sources":["pages/coupon/components/list.vue","../../../../develop/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY2xhc3NfcHJvamVjdC9qem8yby9qem8yby1mcm9udC9qem8yby1jb25zdW1lci9wYWdlcy9jb3Vwb24vY29tcG9uZW50cy9saXN0LnZ1ZQ"],"sourcesContent":["<!--优惠券列表组件-->\r\n<template>\r\n  <view>\r\n    <!-- tab切换 -->\r\n    <view class=\"tabScroll\">\r\n      <view class=\"itemTab box\">\r\n        <view class=\"tabBox\" :class=\"activeIndex === '' ? 'active' : ''\">\r\n          <view\r\n            class=\"tabItem\"\r\n            :class=\"activeIndex === item.value ? 'active' : ''\"\r\n            v-for=\"(item, index) in couponTabData\"\r\n            @click=\"changeTab(item.value)\"\r\n            :key=\"index\"\r\n          >\r\n            <view class=\"bLine\"></view>\r\n            {{ item.label }}\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <!-- end -->\r\n    <!-- 列表 -->\r\n    <view class=\"main\">\r\n      <!-- 垂直滚动区域  scroll和swiper的高度都要给且是一样的高度-->\r\n      <view>\r\n        <scroll-view scroll-y=\"true\">\r\n          <view class=\"timeList\">\r\n            <view\r\n              class=\"box boxRadius item\"\r\n              v-for=\"(item, index) in itemData\"\r\n              :key=\"index\"\r\n            >\r\n              <view\r\n                :class=\"[\r\n                  type !== 1 && activeIndex !== 1 ? 'grey left' : 'left',\r\n                  item.remainNum <= 0 && item.remainNum !== null\r\n                    ? 'reLeft'\r\n                    : '',\r\n                ]\"\r\n              >\r\n                <view class=\"price\">\r\n                  <text class=\"unit\" v-if=\"item.type === 1\">￥</text>\r\n                  <text class=\"money\"\r\n                    >{{\r\n                      item.type === 1\r\n                        ? Number(item.discountAmount).toFixed(0)\r\n                        : convertDiscountPercentageToNumber(\r\n                            Number(item.discountRate)\r\n                          ).integer\r\n                    }}\r\n                  </text>\r\n                  <text v-if=\"item.type === 2\">{{\r\n                    convertDiscountPercentageToNumber(Number(item.discountRate))\r\n                      .decimal\r\n                  }}</text>\r\n                  <text class=\"unit\" v-if=\"item.type === 2\">折</text>\r\n                </view>\r\n                <view\r\n                  class=\"button\"\r\n                  :class=\"item.remainNum > 0 ? '' : 'reButton'\"\r\n                  v-if=\"activeIndex === 1 && type === 1\"\r\n                  @click=\"handleAddCoupon(item.id)\"\r\n                  >{{ item.remainNum > 0 ? '立即领取' : '已抢光' }}</view\r\n                >\r\n              </view>\r\n              <view class=\"right\">\r\n                <view class=\"title\">{{ item.name }}</view>\r\n                <view class=\"time\" v-if=\"item.type === 1\">\r\n                  <text v-if=\"Number(item.amountCondition).toFixed(0) == 0\" class=\"mainColor\"\r\n                    >无门槛</text\r\n                  ><text v-else class=\"mainColor\"\r\n                    >满{{ Number(item.amountCondition).toFixed(0) }}元</text\r\n                  >立减{{ Number(item.discountAmount).toFixed(0) }}元\r\n                </view>\r\n                <view class=\"time\" v-if=\"item.type === 2\">\r\n                  <text v-if=\"Number(item.amountCondition).toFixed(0) == 0\" class=\"mainColor\"\r\n                    >无门槛</text\r\n                  ><text v-else class=\"mainColor\"\r\n                    >满{{ Number(item.amountCondition).toFixed(0) }}元</text\r\n                  >立享{{\r\n                    convertDiscountPercentageToNumber(Number(item.discountRate))\r\n                      .integer\r\n                  }}折\r\n                </view>\r\n                <view class=\"time\" v-if=\"type == 1\">\r\n                  {{\r\n                    formatDateTimeToDateString(\r\n                      new Date(item.distributeStartTime.replace(/-/g, '/'))\r\n                    )\r\n                  }}~{{\r\n                    formatDateTimeToDateString(\r\n                      new Date(item.distributeEndTime.replace(/-/g, '/'))\r\n                    )\r\n                  }}\r\n                </view>\r\n                <view class=\"time\" v-else>\r\n                  <text>有效期至：</text>{{ formatDateTimeToDateString(\r\n                    new Date(item.validityTime.replace(/-/g, '/'))\r\n                  ) }}\r\n                </view>\r\n              </view>\r\n              <image\r\n                v-if=\"type !== 1 && activeIndex == 2\"\r\n                src=\"../../../static/ysy@2x.png\"\r\n                mode=\"scaleToFill\"\r\n                class=\"ysy\"\r\n              />\r\n              <image\r\n                v-if=\"type !== 1 && activeIndex == 3\"\r\n                src=\"../../../static/ygq@2x.png\"\r\n                mode=\"scaleToFill\"\r\n                class=\"ysy\"\r\n              />\r\n            </view>\r\n          </view>\r\n\r\n          <!-- 下拉加载更多Lodding -->\r\n          <view v-if=\"itemData.length > 6\"\r\n            ><uni-load-more :status=\"moreStatus\" :content-text=\"contentText\"\r\n          /></view>\r\n          <!-- end -->\r\n        </scroll-view>\r\n      </view>\r\n      <!-- 无数据显示 -->\r\n      <view v-if=\"itemData.length === 0 && loading\">\r\n        <EmptyPage :emptyInfo=\"emptyInfo\" />\r\n      </view>\r\n      <!-- end -->\r\n    </view>\r\n    <!-- end -->\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue';\r\nimport {\r\n  formatDateTimeToDateString,\r\n  convertDiscountPercentageToNumber,\r\n} from '@/utils/index.js';\r\nimport { onReachBottom, onLoad } from '@dcloudio/uni-app';\r\n// 组件\r\n// 无数据\r\nimport EmptyPage from '@/components/EmptyPage/index.vue';\r\n// 基础数据\r\n\r\n// 获取父组件值、方法\r\nconst props = defineProps({\r\n  itemData: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n  moreStatus: {\r\n    type: String,\r\n    default: 'noMore',\r\n  },\r\n  loading: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  couponTabData: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n  type: {\r\n    type: Number,\r\n    default: 0,\r\n  },\r\n});\r\n\r\nconst emit = defineEmits([\r\n  'setTabIndex',\r\n  'onReachBottom',\r\n  'handleDelete',\r\n  'addCoupons',\r\n]);\r\nconst activeIndex = ref(1); //当前tab\r\nconst emptyInfo = ref('暂无优惠券');\r\n// const itemData = ref([]); //预约数据\r\nconst contentText = ref({\r\n  //加载状态说明\r\n  contentdown: '上拉加载更多',\r\n  contentrefresh: '努力加载中...',\r\n  contentnomore: '- 没有更多了 -',\r\n});\r\nconst pagesCount = ref(null);\r\n//胶囊底部距离头部的距离\r\nlet capsuleBottom = ref();\r\n// ------定义方法------\r\nonLoad(() => {\r\n  uni.getSystemInfo({\r\n    success: () => {\r\n      capsuleBottom.value = uni.getMenuButtonBoundingClientRect().bottom + 12;\r\n    },\r\n  });\r\n  let pages = getCurrentPages();\r\n  pagesCount.value = pages.length;\r\n});\r\nwatch(\r\n  () => props.itemData,\r\n  (newVal) => {\r\n    // itemData.value = newVal;\r\n    if (newVal.length > 0) {\r\n      emptyInfo.value = '暂无优惠券';\r\n    } else {\r\n      emptyInfo.value = '暂无优惠券';\r\n    }\r\n  }\r\n);\r\n// 切换tab\r\nconst changeTab = (index) => {\r\n  // 点击的还是当前数据的时候直接return\r\n  if (activeIndex.value == index) {\r\n    return;\r\n  }\r\n  activeIndex.value = index;\r\n  emit('setTabIndex', index);\r\n};\r\n// 添加优惠券\r\nconst handleAddCoupon = (val) => {\r\n  emit('addCoupons', val);\r\n};\r\n// 上下拉取\r\nonReachBottom(() => {\r\n  emit('onReachBottom');\r\n});\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import url('@/styles/theme.scss');\r\n.btn {\r\n  width: 156rpx;\r\n  height: 60rpx;\r\n  line-height: 60rpx;\r\n  text-align: center;\r\n  color: var(--essential-color-red);\r\n}\r\n.item {\r\n  &:nth-child(1) {\r\n    margin-top: 16rpx;\r\n  }\r\n}\r\n.timeList .item {\r\n  padding: 0;\r\n  display: flex;\r\n  background-color: transparent;\r\n  position: relative;\r\n  .ysy {\r\n    position: absolute;\r\n    width: 168rpx;\r\n    height: 128rpx;\r\n    right: -11rpx;\r\n    top: -7.4rpx;\r\n  }\r\n  .grey {\r\n    background-image: url('../../../static/yhjsy@2x.png') !important;\r\n  }\r\n  .left {\r\n    min-width: 234rpx;\r\n    width: 234rpx;\r\n    min-height: 208rpx;\r\n    background-image: url('../../../static/quan@2x.png');\r\n    background-size: 100% 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    .price {\r\n      font-family: PingFangSC-SNaNpxibold;\r\n      font-weight: 600;\r\n      color: #ffffff;\r\n      .unit {\r\n        font-size: 40rpx;\r\n      }\r\n      .money {\r\n        font-size: 80rpx;\r\n        white-space: nowrap;\r\n        text {\r\n          font-size: 40rpx;\r\n        }\r\n      }\r\n    }\r\n    .button {\r\n      margin-top: 12rpx;\r\n      width: 140rpx;\r\n      height: 44rpx;\r\n      line-height: 44rpx;\r\n      font-size: 24rpx;\r\n      color: #f64747;\r\n      background-color: #fff;\r\n      border-radius: 40rpx;\r\n      text-align: center;\r\n      font-weight: 500;\r\n    }\r\n    .reButton {\r\n      background: #cda3a3;\r\n      color: #fff;\r\n      cursor: no-drop;\r\n      pointer-events: none;\r\n    }\r\n  }\r\n  .reLeft {\r\n    background-image: url('../../../static/yqgbj@2x.png') !important;\r\n  }\r\n  .right {\r\n    width: 100%;\r\n    background-color: #fff;\r\n    padding-left: 40rpx;\r\n    padding-top: 31rpx;\r\n    border-top-right-radius: 16rpx;\r\n    border: 1px solid #eeeeee;\r\n    border-left: none;\r\n    border-bottom-right-radius: 16rpx;\r\n    .title {\r\n      font-weight: 500;\r\n      font-size: 32rpx;\r\n      color: #19232b;\r\n      margin-bottom: 8rpx;\r\n    }\r\n    .time {\r\n      padding: 0;\r\n      font-size: 24rpx;\r\n      color: #19232b;\r\n      line-height: 56rpx;\r\n      height: 56rpx;\r\n      text {\r\n        color: #80878c;\r\n      }\r\n    }\r\n  }\r\n}\r\n.mainColor {\r\n  color: #19232b !important;\r\n}\r\n</style>\r\n","import Component from 'D:/class_project/jzo2o/jzo2o-front/jzo2o-consumer/pages/coupon/components/list.vue'\nwx.createComponent(Component)"],"names":["ref","onLoad","uni","watch","onReachBottom"],"mappings":";;;;;;;;;;;;AA8IA,MAAM,YAAY,MAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAI7B,UAAM,QAAQ;AAuBd,UAAM,OAAO;AAMb,UAAM,cAAcA,cAAAA,IAAI,CAAC;AACzB,UAAM,YAAYA,cAAAA,IAAI,OAAO;AAE7B,UAAM,cAAcA,cAAAA,IAAI;AAAA;AAAA,MAEtB,aAAa;AAAA,MACb,gBAAgB;AAAA,MAChB,eAAe;AAAA,IACjB,CAAC;AACD,UAAM,aAAaA,cAAAA,IAAI,IAAI;AAE3B,QAAI,gBAAgBA,cAAG,IAAA;AAEvBC,kBAAAA,OAAO,MAAM;AACXC,oBAAAA,MAAI,cAAc;AAAA,QAChB,SAAS,MAAM;AACb,wBAAc,QAAQA,cAAG,MAAC,gCAA+B,EAAG,SAAS;AAAA,QACtE;AAAA,MACL,CAAG;AACD,UAAI,QAAQ;AACZ,iBAAW,QAAQ,MAAM;AAAA,IAC3B,CAAC;AACDC,kBAAK;AAAA,MACH,MAAM,MAAM;AAAA,MACZ,CAAC,WAAW;AAEV,YAAI,OAAO,SAAS,GAAG;AACrB,oBAAU,QAAQ;AAAA,QACxB,OAAW;AACL,oBAAU,QAAQ;AAAA,QACnB;AAAA,MACF;AAAA,IACH;AAEA,UAAM,YAAY,CAAC,UAAU;AAE3B,UAAI,YAAY,SAAS,OAAO;AAC9B;AAAA,MACD;AACD,kBAAY,QAAQ;AACpB,WAAK,eAAe,KAAK;AAAA,IAC3B;AAEA,UAAM,kBAAkB,CAAC,QAAQ;AAC/B,WAAK,cAAc,GAAG;AAAA,IACxB;AAEAC,kBAAAA,cAAc,MAAM;AAClB,WAAK,eAAe;AAAA,IACtB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/ND,GAAG,gBAAgB,SAAS;"}